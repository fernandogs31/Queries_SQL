SELECT distinct HOU.ORGANIZATION_CODE EMPRESA,
                HL.LOCATION_CODE LOCAL_ENTREGA,
                reo.status,
                REO.OPERATION_ID RECEBIMENTO,
                CFIT.INVOICE_TYPE_CODE TIPO_NF,
                CFIT.DESCRIPTION DESCRICAO_TIPO_NF,
                CFFE.DOCUMENT_NUMBER CNPJ_GE,
                RV.VENDOR_NAME FORNECEDOR_CLIENTE,
                RV.DOCUMENT_NUMBER CNPJ_CPF,
                RV.VENDOR_SITE_CODE VENDOR_SITE_aCODE,
                RV.CITY_CODE CIDADE,
                RV.STATE_CODE ESTADO,
                RI.INVOICE_NUM NOTA_FISCAL,
                RI.INVOICE_DATE DATA_EMISSAO,
                REO.RECEIVE_DATE DATA_RECEBIMENTO,
                RI.FIRST_PAYMENT_DATE VENCTO,
                RI.DESCRIPTION DESCRICAO,
                CFS.STATE_CODE ESTADO_ORIGEM,
                CFC1.CITY_CODE CIDADE_ORIGEM,
                CFS1.STATE_CODE ESTADO_DESTINO,                
                CFC2.CITY_CODE CIDADE_DESTINO,
                dbms_lob.substr(RI.COMMENTS, 5000, 1) INFORMAÃ‡OES_ADICIONAIS,
                dbms_lob.substr(RI.FISCO_ADDITIONAL_INFORMATION, 5000, 1),
                dbms_lob.substr(RI.REFERENCE, 5000, 1),
                RI.ELETRONIC_INVOICE_KEY CHAVE_ELETRONICA,
                (1/ri.PO_CONVERSION_RATE) TAXA_CAMBIO,
                RI.TOTAL_FOB_AMOUNT,
                RI.IMPORTATION_NUMBER NUMERO_DI,
                RI.DI_DATE DATA_DI,
                RI.FREIGHT_INTERNATIONAL FRETE_INTERN_TOTAL,
                RI.IMPORTATION_INSURANCE_AMOUNT SEGURO_INTERN_TOTAL,
                RI.IMPORT_OTHER_VAL_NOT_ICMS OUTRAS_DESP_SEM_ICMS_TOTAL,
                RI.IMPORT_OTHER_VAL_INCLUDED_ICMS OUTRAS_DESP_COM_ICMS_TOTAL,
                RI.IMPORTATION_TAX_AMOUNT II_TOTAL,
                RI.DOLLAR_CUSTOMS_EXPENSE,
                RI.DOLLAR_FREIGHT_INTERNATIONAL,
                RI.DOLLAR_IMPORTATION_PIS_AMOUNT,
                RI.DOLLAR_IMPORTATION_TAX_AMOUNT,
                RI.DOLLAR_IMPORT_CIDE_AMOUNT,
                RI.DOLLAR_IMPORT_COFINS_AMOUNT,
                RI.DOLLAR_INSURANCE_AMOUNT,
                RI.DOLLAR_INVOICE_AMOUNT,
                RI.DOLLAR_OTHER_VAL_INCLUDED_ICMS,
                RI.DOLLAR_OTHER_VAL_NOT_ICMS,
                RI.DOLLAR_SISCOMEX_AMOUNT,
                RI.DOLLAR_TOTAL_CIF_AMOUNT,
                RI.DOLLAR_TOTAL_FOB_AMOUNT,
                RI.ATTRIBUTE1 WF,
                RI.ATTRIBUTE2 EMBARQUE,
                RI.ATTRIBUTE3 DI,
                CFO.CFO_CODE CFOP,
                RI.FREIGHT_AMOUNT,
                RI.OTHER_EXPENSES,
                RI.GROSS_TOTAL_AMOUNT TOTAL_NOTA,
                RI.RETURN_INVOICE_NUM,
                RI.RETURN_SERIES,
                RI.RETURN_AMOUNT,
                RIL.INVOICE_LINE_ID,
                PHA.SEGMENT1 PO_RMA,
                MSI.SEGMENT1 ITEM,
                RIL.DESCRIPTION DESCRICAO_ITEM,
                RIL.ITEM_NUMBER SEQ_ITEM,
                CFFC.CLASSIFICATION_CODE NCM,
               CFIU.UTILIZATION_CODE UTILIZACAO_FISCAL,
                CFIU.DESCRIPTION DESCRICAO_UTILIZACAO_FISCAL,
                RIL.QUANTITY QUANTIDADE,
                RIL.UNIT_PRICE PRECO_UNIT,
                RIL.NET_AMOUNT PRECO_TOTAL_ITEM,
                RIL.TOTAL_AMOUNT ITEM_TOTAL_AMOUNT,
                RIL.ICMS_BASE BASE_ICMS,
                RIL.ICMS_TAX ALIQUOTA_ICMS,
                RIL.ICMS_AMOUNT VALOR_ICMS,
                RIL.DEFERRED_ICMS_AMOUNT                 ICMS_DIFERIDO_AMNT,
                RIL.ICMS_AMOUNT_RECOVER CREDITO_ICMS,
                RIL.TRIBUTARY_STATUS_CODE CST_ICMS,
                RIL.ICMS_TAX_CODE INDICADOR_ICMS,
                RIL.DIFF_ICMS_TAX DIFAL_ALIQUOTA,
                RIL.DIFF_ICMS_AMOUNT DIFAL_VALOR,
                RIL.DIFF_ICMS_AMOUNT_RECOVER,
                RIL.ICMS_ST_BASE BASE_ICMS_ST,
                RIL.ICMS_ST_AMOUNT ICMS_ST_AMOUNT,
                RIL.ICMS_DEST_BASE_AMOUNT BASE_ICMS_DEST,
                RIL.ICMS_FCP_DEST_PERC FCP_RATE,
                RIL.ICMS_DEST_TAX ICMS_RATE_DEST,
                RIL.ICMS_SHARING_INTER_PERC,
                RIL.ICMS_FCP_AMOUNT,
                RIL.ICMS_SHARING_SOURCE_AMOUNT,
                RIL.ICMS_SHARING_DEST_AMOUNT,
                RIL.CEST_CODE,
                RIL.IPI_BASE_AMOUNT BASE_IPI,
                RIL.IPI_TAX ALIQUOTA_IPI,
                RIL.IPI_AMOUNT VALOR_IPI,
                RIL.IPI_AMOUNT_RECOVER CREDITO_IPI,
                RIL.IPI_TRIBUTARY_CODE CST_IPI,
                RIL.IPI_TAX_CODE INDICADOR_IPI,
                RIL.PIS_BASE_AMOUNT BASE_PIS,
                RIL.PIS_TAX_RATE ALIQ_PIS,
                RIL.PIS_AMOUNT,
                RIL.PIS_AMOUNT_RECOVER CREDITO_PIS,
                RIL.PIS_TRIBUTARY_CODE CST_PIS,
                RIL.COFINS_BASE_AMOUNT BASE_COFINS,
                RIL.COFINS_TAX_RATE ALIQ_COFINS,
                RIL.COFINS_AMOUNT,
                RIL.COFINS_AMOUNT_RECOVER CREDITO_COFINS,
                RIL.COFINS_TRIBUTARY_CODE CST_COFINS,
                RIL.IMPORTATION_PIS_COFINS_BASE BASE_PIS_COFINS_IMPORTACAO,
                RIL.IMPORTATION_PIS_AMOUNT VALOR_PIS_IMPORTACAO,
                RIL.IMPORTATION_COFINS_AMOUNT VALOR_COFINS_IMPORTACAO,
                RIL.IMPORT_OTHER_VAL_NOT_ICMS OUTRS_DESP_SEM_BASE_ICMS_LINHA,
                RIL.IMPORT_OTHER_VAL_INCLUDED_ICMS OUTRS_DESP_COM_BASE_ICMS_LINHA,
                RIL.FOB_AMOUNT,
                RIL.FREIGHT_INTERNACIONAL,
                RIL.IMPORTATION_TAX_AMOUNT,
                RIL.IMPORTATION_INSURANCE_AMOUNT,
                RIL.FCP_BASE_AMOUNT,
                RIL.FCP_RATE,
                RIL.FCP_AMOUNT,
                RIL.FCP_ST_BASE_AMOUNT,
                RIL.FCP_ST_RATE,
                RIL.FCP_ST_AMOUNT,
                RIL.OPERATION_FISCAL_TYPE,
                RI.IR_CATEG CATEGORIA_IRPJ,
                RI.IR_BASE BASE_IRPJ,
                RI.IR_TAX ALIQUOTA_IRPJ,
                RI.IR_AMOUNT IR_RETIDO_PJ,
                CFC.CITY_CODE LOCAL_PRESTACAO_SERVICO,
                RIL.ISS_BASE_AMOUNT BASE_ISS_RETIDO,
                RIL.ISS_TAX_RATE ALIQUOTA_ISS_RETIDO,
                RIL.ISS_TAX_AMOUNT VALOR_ISS_RETIDO,
                RIL.ISS_FO_BASE_AMOUNT BASE_ISS_INFORMATIVO,
                RIL.ISS_FO_TAX_RATE ALIQUOTA_ISS_INFORMATIVO,
                RIL.ISS_FO_AMOUNT VALOR_ISS_INFORMATIVO,
                CFST.SERVICE_TYPE_CODE CODIGO_SERVICO,
                RI.CNO_NUMBER,
                RI.INSS_BASE BASE_INSS,
                RI.INSS_TAX ALIQUOTA_INSS,
                RI.INSS_AMOUNT VALOR_INSS,
                RI.INSS_AUTONOMOUS_INVOICED_TOTAL INSS_AUTONOMO,
                RI.INSS_AUTONOMOUS_TAX ALIQUOTA_INSS_AUTONOMO,
                RI.INSS_AUTONOMOUS_AMOUNT VALOR_INSS_AUTONOMO,
                RI.INSS_ADDITIONAL_BASE_1 BASE_INSS_ADICIONAL_1,
                RI.INSS_ADDITIONAL_TAX_1 ALIQUOTA_INSS_ADICIONAL_1,
                RI.INSS_ADDITIONAL_AMOUNT_1 VALOR_INSS_ADICIONAL_1,
                RI.INSS_ADDITIONAL_BASE_2 BASE_INSS_ADICIONAL_2,
                RI.INSS_ADDITIONAL_TAX_2 ALIQUOTA_INSS_ADICIONAL_2,
                RI.INSS_ADDITIONAL_AMOUNT_2 VALOR_INSS_ADICIONAL_2,
                RI.INSS_ADDITIONAL_BASE_3 BASE_INSS_ADICIONAL_3,
                RI.INSS_ADDITIONAL_TAX_3 ALIQUOTA_INSS_ADICIONAL_3,
                RI.INSS_ADDITIONAL_AMOUNT_3 VALOR_INSS_ADICIONAL_3,
                RI.INCOME_CODE CODIGO_PGTO,
                AW.NAME GRUPO_RETENCAO,
                AW.DESCRIPTION DESCRICAO_GRUPO_RETENCAO,
                RIL.ATTRIBUTE_CATEGORY,
                RIL.ATTRIBUTE1 NF_REMESSA,
                RIL.ATTRIBUTE2 SERIE_REMESSA,
                RIL.ATTRIBUTE3 LOTE,
                NVL(RIL.ATTRIBUTE3,RIL.ATTRIBUTE14) LOTE_INT_REQ,
                RIL.ATTRIBUTE4 QTDE_LOTE,
                RIL.MED_MAXIMUM_PRICE_CONSUMER,
                RIL.ANVISA_PRODUCT_CODE,
                RIL.ANVISA_EXEMPTION_REAZON,
                FD.USER_NAME SSO,
                FD.DESCRIPTION NOME,
                FD.EMAIL_ADDRESS,
                GCC.SEGMENT8 PLINE

  FROM APPS.CLL_F189_VENDORS_V           RV,
       APPS.CLL_F189_ENTRY_OPERATIONS    REO,
       APPS.CLL_F189_INVOICES            RI,
       APPS.CLL_F189_INVOICE_LINES       RIL,
       APPS.MTL_PARAMETERS               HOU,
       APPS.CLL_F189_FISCAL_OPERATIONS   CFO,
       APPS.MTL_SYSTEM_ITEMS             MSI,
       APPS.CLL_F189_INVOICE_TYPES       CFIT,
       APPS.AP_AWT_GROUPS                AW,
       APPS.CLL_F189_CITIES              CFC,
       APPS.CLL_F189_CITY_SRV_TYPE_RELS  CFCST,
       APPS.CLL_F189_SERVICE_TYPES       CFST,
       APPS.CLL_F189_ITEM_UTILIZATIONS   CFIU,
       APPS.CLL_F189_FISCAL_CLASS        CFFC,
       APPS.HR_LOCATIONS_ALL             HL,
       APPS.FND_USER                     FD,
       APPS.CLL_F189_FISCAL_ENTITIES_ALL CFFE,
       APPS.PO_LINE_LOCATIONS_ALL        PLLA,
       APPS.PO_HEADERS_ALL               PHA,
       APPS.GL_CODE_COMBINATIONS_KFV     GCC,
        APPS.CLL_F189_STATES              CFS,
       APPS.CLL_F189_STATES              CFS1,
       APPS.CLL_F189_CITIES              CFC1,
       APPS.CLL_F189_CITIES              CFC2

WHERE 1 = 1
   AND RI.INVOICE_ID = RIL.INVOICE_ID
   AND RI.ENTITY_ID = RV.ENTITY_ID
   AND REO.OPERATION_ID = RI.OPERATION_ID
   AND REO.ORGANIZATION_ID = RI.ORGANIZATION_ID
   and reo.status = 'COMPLETE'
   AND HOU.ORGANIZATION_ID = RI.ORGANIZATION_ID
   AND RIL.CFO_ID = CFO.CFO_ID
   AND MSI.INVENTORY_ITEM_ID(+) = RIL.ITEM_ID
   AND MSI.ORGANIZATION_ID = RIL.ORGANIZATION_ID
   AND MSI.COST_OF_SALES_ACCOUNT = GCC.CODE_COMBINATION_ID
   AND CFIT.INVOICE_TYPE_ID = RI.INVOICE_TYPE_ID
   AND RIL.AWT_GROUP_ID = AW.GROUP_ID(+)
   AND RI.ISS_CITY_ID = CFC.CITY_ID(+)
   AND RI.DFLT_CITY_SERVICE_TYPE_REL_ID = CFCST.CITY_SERVICE_TYPE_REL_ID(+)
   AND CFCST.MUNICIPAL_SERVICE_TYPE_ID = CFST.SERVICE_TYPE_ID(+)
   AND CFIU.UTILIZATION_ID = RIL.UTILIZATION_ID
   AND CFFC.CLASSIFICATION_ID = RIL.CLASSIFICATION_ID
   AND HL.LOCATION_ID = REO.LOCATION_ID
   AND REO.LAST_UPDATED_BY = FD.USER_ID
   AND CFFE.LOCATION_ID = HL.LOCATION_ID
   AND RIL.LINE_LOCATION_ID = PLLA.LINE_LOCATION_ID(+)
   AND PHA.PO_HEADER_ID(+) = PLLA.PO_HEADER_ID
   AND RI.SOURCE_STATE_ID = CFS.STATE_ID (+)
   AND RI.DESTINATION_STATE_ID = CFS1.STATE_ID (+)
   AND RI.SOURCE_CITY_ID = CFC1.CITY_ID (+)
   AND RI.DESTINATION_CITY_ID = CFC2.CITY_ID (+)
   AND  ril.requisition_line_id IS NULL
   --AND HOU.ORGANIZATION_CODE in ('CSC','CTC','MRC','SGC')
   --AND CFO.CFO_CODE in ('3101')  
   --AND RI.OPERATION_ID = 10115 -- (141774,141775,141766) --> RI NUMBER
   --AND RV.DOCUMENT_TYPE = 'CPF'
   AND trunc(REO.RECEIVE_DATE) between  TO_date('01/02/2024', 'dd/mm/yyyy') and  TO_date('02/03/2024', 'dd/mm/yyyy')

UNION ALL

SELECT distinct HOU.ORGANIZATION_CODE EMPRESA,
                HL.LOCATION_CODE LOCAL_ENTREGA,
                reo.status,
                REO.OPERATION_ID RECEBIMENTO,
                CFIT.INVOICE_TYPE_CODE TIPO_NF,
                CFIT.DESCRIPTION DESCRICAO_TIPO_NF,
                CFFE.DOCUMENT_NUMBER CNPJ_GE,
                RC.CUSTOMER_NAME FORNECEDOR_CLIENTE,
                RC.DOCUMENT_NUMBER CNPJ_CPF,
                '' VENDOR_SITE_CODE,
                RC.CITY_CODE CIDADE,
                RC.STATE_CODE ESTADO,
                RI.INVOICE_NUM NOTA_FISCAL,
                RI.INVOICE_DATE DATA_EMISSAO,
                REO.RECEIVE_DATE DATA_RECEBIMENTO,
                RI.FIRST_PAYMENT_DATE VENCTO,
                RI.DESCRIPTION DESCRICAO,
                CFS.STATE_CODE ESTADO_ORIGEM,
                CFC1.CITY_CODE CIDADE_ORIGEM,
                CFS1.STATE_CODE ESTADO_DESTINO,
                CFC2.CITY_CODE CIDADE_DESTINO,
                dbms_lob.substr(RI.COMMENTS, 5000, 1) INFORMAÃ‡OES_ADICIONAIS,
                dbms_lob.substr(RI.FISCO_ADDITIONAL_INFORMATION, 5000, 1),
                dbms_lob.substr(RI.REFERENCE, 5000, 1),
                RI.ELETRONIC_INVOICE_KEY CHAVE_ELETRONICA,
                (1/ri.PO_CONVERSION_RATE) TAXA_CAMBIO,
                RI.TOTAL_FOB_AMOUNT,
                RI.IMPORTATION_NUMBER NUMERO_DI,
                RI.DI_DATE DATA_DI,
                RI.FREIGHT_INTERNATIONAL FRETE_INTERN_TOTAL,
                RI.IMPORTATION_INSURANCE_AMOUNT SEGURO_INTERN_TOTAL,
                RI.IMPORT_OTHER_VAL_NOT_ICMS OUTRAS_DESP_SEM_ICMS_TOTAL,
                RI.IMPORT_OTHER_VAL_INCLUDED_ICMS OUTRAS_DESP_COM_ICMS_TOTAL,
                RI.IMPORTATION_TAX_AMOUNT II_TOTAL,
                RI.DOLLAR_CUSTOMS_EXPENSE,
                RI.DOLLAR_FREIGHT_INTERNATIONAL,
                RI.DOLLAR_IMPORTATION_PIS_AMOUNT,
                RI.DOLLAR_IMPORTATION_TAX_AMOUNT,
                RI.DOLLAR_IMPORT_CIDE_AMOUNT,
                RI.DOLLAR_IMPORT_COFINS_AMOUNT,
                RI.DOLLAR_INSURANCE_AMOUNT,
                RI.DOLLAR_INVOICE_AMOUNT,
                RI.DOLLAR_OTHER_VAL_INCLUDED_ICMS,
                RI.DOLLAR_OTHER_VAL_NOT_ICMS,
                RI.DOLLAR_SISCOMEX_AMOUNT,
                RI.DOLLAR_TOTAL_CIF_AMOUNT,
                RI.DOLLAR_TOTAL_FOB_AMOUNT,
                RI.ATTRIBUTE1 WF,
                RI.ATTRIBUTE2 EMBARQUE,
                RI.ATTRIBUTE3 DI,
                CFO.CFO_CODE CFOP,
                RI.FREIGHT_AMOUNT,
                RI.OTHER_EXPENSES,
                RI.GROSS_TOTAL_AMOUNT TOTAL_NOTA,
                RI.RETURN_INVOICE_NUM,
                RI.RETURN_SERIES,
                RI.RETURN_AMOUNT,
                RIL.INVOICE_LINE_ID,
                TO_CHAR(OOH.ORDER_NUMBER) PO_RMA,
                MSI.SEGMENT1 ITEM,
                RIL.DESCRIPTION DESCRICAO_ITEM,
                RIL.ITEM_NUMBER SEQ_ITEM,
                CFFC.CLASSIFICATION_CODE NCM,
                CFIU.UTILIZATION_CODE UTILIZACAO_FISCAL,
                CFIU.DESCRIPTION DESCRICAO_UTILIZACAO_FISCAL,
                RIL.QUANTITY QUANTIDADE,
                RIL.UNIT_PRICE PRECO_UNIT,
                RIL.NET_AMOUNT PRECO_TOTAL_ITEM,
                RIL.TOTAL_AMOUNT ITEM_TOTAL_AMOUNT,
                RIL.ICMS_BASE BASE_ICMS,
                RIL.ICMS_TAX ALIQUOTA_ICMS,
                RIL.ICMS_AMOUNT VALOR_ICMS,
                RIL.DEFERRED_ICMS_AMOUNT                 ICMS_DIFERIDO_AMNT,
                RIL.ICMS_AMOUNT_RECOVER CREDITO_ICMS,
                RIL.TRIBUTARY_STATUS_CODE CST_ICMS,
                RIL.ICMS_TAX_CODE INDICADOR_ICMS,
                RIL.DIFF_ICMS_TAX DIFAL_ALIQUOTA,
                RIL.DIFF_ICMS_AMOUNT DIFAL_VALOR,
                RIL.DIFF_ICMS_AMOUNT_RECOVER,
                RIL.ICMS_ST_BASE BASE_ICMS_ST,
                RIL.ICMS_ST_AMOUNT ICMS_ST_AMOUNT,
                RIL.ICMS_DEST_BASE_AMOUNT BASE_ICMS_DEST,
                RIL.ICMS_FCP_DEST_PERC FCP_RATE,
                RIL.ICMS_DEST_TAX ICMS_RATE_DEST,
                RIL.ICMS_SHARING_INTER_PERC,
                RIL.ICMS_FCP_AMOUNT,
                RIL.ICMS_SHARING_SOURCE_AMOUNT,
                RIL.ICMS_SHARING_DEST_AMOUNT,
                RIL.CEST_CODE,
                RIL.IPI_BASE_AMOUNT BASE_IPI,
                RIL.IPI_TAX ALIQUOTA_IPI,
                RIL.IPI_AMOUNT VALOR_IPI,
                RIL.IPI_AMOUNT_RECOVER CREDITO_IPI,
                RIL.IPI_TRIBUTARY_CODE CST_IPI,
                RIL.IPI_TAX_CODE INDICADOR_IPI,
                RIL.PIS_BASE_AMOUNT BASE_PIS,
                RIL.PIS_TAX_RATE ALIQ_PIS,
                RIL.PIS_AMOUNT,
                RIL.PIS_AMOUNT_RECOVER CREDITO_PIS,
                RIL.PIS_TRIBUTARY_CODE CST_PIS,
                RIL.COFINS_BASE_AMOUNT BASE_COFINS,
                RIL.COFINS_TAX_RATE ALIQ_COFINS,
                RIL.COFINS_AMOUNT,
                RIL.COFINS_AMOUNT_RECOVER CREDITO_COFINS,
                RIL.COFINS_TRIBUTARY_CODE CST_COFINS,
                RIL.IMPORTATION_PIS_COFINS_BASE BASE_PIS_COFINS_IMPORTACAO,
                RIL.IMPORTATION_PIS_AMOUNT VALOR_PIS_IMPORTACAO,
                RIL.IMPORTATION_COFINS_AMOUNT VALOR_COFINS_IMPORTACAO,
                RIL.IMPORT_OTHER_VAL_NOT_ICMS OUTRS_DESP_SEM_BASE_ICMS_LINHA,
                RIL.IMPORT_OTHER_VAL_INCLUDED_ICMS OUTRS_DESP_COM_BASE_ICMS_LINHA,
                RIL.FOB_AMOUNT,
                RIL.FREIGHT_INTERNACIONAL,
                RIL.IMPORTATION_TAX_AMOUNT,
                RIL.IMPORTATION_INSURANCE_AMOUNT,
                RIL.FCP_BASE_AMOUNT,
                RIL.FCP_RATE,
                RIL.FCP_AMOUNT,
                RIL.FCP_ST_BASE_AMOUNT,
                RIL.FCP_ST_RATE,
                RIL.FCP_ST_AMOUNT,
                RIL.OPERATION_FISCAL_TYPE,
                RI.IR_CATEG CATEGORIA_IRPJ,
                RI.IR_BASE BASE_IRPJ,
                RI.IR_TAX ALIQUOTA_IRPJ,
                RI.IR_AMOUNT IR_RETIDO_PJ,
                CFC.CITY_CODE LOCAL_PRESTACAO_SERVICO,
                RIL.ISS_BASE_AMOUNT BASE_ISS_RETIDO,
                RIL.ISS_TAX_RATE ALIQUOTA_ISS_RETIDO,
                RIL.ISS_TAX_AMOUNT VALOR_ISS_RETIDO,
                RIL.ISS_FO_BASE_AMOUNT BASE_ISS_INFORMATIVO,
                RIL.ISS_FO_TAX_RATE ALIQUOTA_ISS_INFORMATIVO,
                RIL.ISS_FO_AMOUNT VALOR_ISS_INFORMATIVO,
                CFST.SERVICE_TYPE_CODE CODIGO_SERVICO,
                RI.CNO_NUMBER,
                RI.INSS_BASE BASE_INSS,
                RI.INSS_TAX ALIQUOTA_INSS,
                RI.INSS_AMOUNT VALOR_INSS,
                RI.INSS_AUTONOMOUS_INVOICED_TOTAL INSS_AUTONOMO,
                RI.INSS_AUTONOMOUS_TAX ALIQUOTA_INSS_AUTONOMO,
                RI.INSS_AUTONOMOUS_AMOUNT VALOR_INSS_AUTONOMO,
                RI.INSS_ADDITIONAL_BASE_1 BASE_INSS_ADICIONAL_1,
                RI.INSS_ADDITIONAL_TAX_1 ALIQUOTA_INSS_ADICIONAL_1,
                RI.INSS_ADDITIONAL_AMOUNT_1 VALOR_INSS_ADICIONAL_1,
                RI.INSS_ADDITIONAL_BASE_2 BASE_INSS_ADICIONAL_2,
                RI.INSS_ADDITIONAL_TAX_2 ALIQUOTA_INSS_ADICIONAL_2,
                RI.INSS_ADDITIONAL_AMOUNT_2 VALOR_INSS_ADICIONAL_2,
                RI.INSS_ADDITIONAL_BASE_3 BASE_INSS_ADICIONAL_3,
                RI.INSS_ADDITIONAL_TAX_3 ALIQUOTA_INSS_ADICIONAL_3,
                RI.INSS_ADDITIONAL_AMOUNT_3 VALOR_INSS_ADICIONAL_3,
                RI.INCOME_CODE CODIGO_PGTO,
                AW.NAME GRUPO_RETENCAO,
                AW.DESCRIPTION DESCRICAO_GRUPO_RETENCAO,
                RIL.ATTRIBUTE_CATEGORY,
                RIL.ATTRIBUTE1 NF_REMESSA,
                RIL.ATTRIBUTE2 SERIE_REMESSA,
                RIL.ATTRIBUTE3 LOTE,                
                NVL(RIL.ATTRIBUTE3,RIL.ATTRIBUTE14) LOTE_INT_REQ,
                RIL.ATTRIBUTE4 QTDE_LOTE,
                RIL.MED_MAXIMUM_PRICE_CONSUMER,
                RIL.ANVISA_PRODUCT_CODE,
                RIL.ANVISA_EXEMPTION_REAZON,
                FD.USER_NAME SSO,
                FD.DESCRIPTION NOME,
                FD.EMAIL_ADDRESS,
                GCC.SEGMENT8 PLINE

  FROM APPS.CLL_F189_CUSTOMERS_V         RC,
       APPS.CLL_F189_ENTRY_OPERATIONS    REO,
       APPS.CLL_F189_INVOICES            RI,
       APPS.CLL_F189_INVOICE_LINES       RIL,
       APPS.MTL_PARAMETERS               HOU,
       APPS.CLL_F189_FISCAL_OPERATIONS   CFO,
       APPS.MTL_SYSTEM_ITEMS             MSI,
       APPS.CLL_F189_INVOICE_TYPES       CFIT,
       APPS.AP_AWT_GROUPS                AW,
       APPS.CLL_F189_CITIES              CFC,
       APPS.CLL_F189_CITY_SRV_TYPE_RELS  CFCST,
       APPS.CLL_F189_SERVICE_TYPES       CFST,
       APPS.CLL_F189_ITEM_UTILIZATIONS   CFIU,
       APPS.CLL_F189_FISCAL_CLASS        CFFC,
       APPS.HR_LOCATIONS_ALL             HL,
       APPS.FND_USER                     FD,
       APPS.CLL_F189_FISCAL_ENTITIES_ALL CFFE,
       APPS.OE_ORDER_LINES_ALL           OOL,
       APPS.OE_ORDER_HEADERS_ALL         OOH,
       APPS.GL_CODE_COMBINATIONS_KFV     GCC,
       APPS.CLL_F189_STATES              CFS,
       APPS.CLL_F189_STATES              CFS1,
       APPS.CLL_F189_CITIES              CFC1,
       APPS.CLL_F189_CITIES              CFC2

WHERE 1 = 1
   AND RI.INVOICE_ID = RIL.INVOICE_ID
   AND RI.ENTITY_ID = RC.ENTITY_ID
   AND REO.OPERATION_ID = RI.OPERATION_ID
   AND REO.ORGANIZATION_ID = RI.ORGANIZATION_ID
   and reo.status = 'COMPLETE'
   AND HOU.ORGANIZATION_ID = RI.ORGANIZATION_ID
   AND RIL.CFO_ID = CFO.CFO_ID
   AND MSI.INVENTORY_ITEM_ID(+) = RIL.ITEM_ID
   AND MSI.ORGANIZATION_ID = RIL.ORGANIZATION_ID
   AND MSI.COST_OF_SALES_ACCOUNT = GCC.CODE_COMBINATION_ID
   AND CFIT.INVOICE_TYPE_ID = RI.INVOICE_TYPE_ID
   AND RIL.AWT_GROUP_ID = AW.GROUP_ID(+)
   AND RI.ISS_CITY_ID = CFC.CITY_ID(+)
   AND RI.DFLT_CITY_SERVICE_TYPE_REL_ID = CFCST.CITY_SERVICE_TYPE_REL_ID(+)
   AND CFCST.MUNICIPAL_SERVICE_TYPE_ID = CFST.SERVICE_TYPE_ID(+)
   AND CFIU.UTILIZATION_ID = RIL.UTILIZATION_ID
   AND CFFC.CLASSIFICATION_ID = RIL.CLASSIFICATION_ID
   AND HL.LOCATION_ID = REO.LOCATION_ID
   AND REO.LAST_UPDATED_BY = FD.USER_ID
   AND CFFE.LOCATION_ID = HL.LOCATION_ID
   AND OOH.HEADER_ID = OOL.HEADER_ID
   AND OOL.LINE_ID = RIL.RMA_INTERFACE_ID(+)
   AND RI.SOURCE_STATE_ID = CFS.STATE_ID (+)
   AND RI.DESTINATION_STATE_ID = CFS1.STATE_ID (+)
   AND RI.SOURCE_CITY_ID = CFC1.CITY_ID (+)
   AND RI.DESTINATION_CITY_ID = CFC2.CITY_ID (+)
   --AND HOU.ORGANIZATION_CODE in ('CSC','CTC','MRC','SGC')
   --AND CFO.CFO_CODE in ('3101')
   --AND RI.OPERATION_ID = 10115 --> RI NUMBER
   --AND RC.DOCUMENT_TYPE = 'CPF'
   AND trunc(REO.RECEIVE_DATE) between  TO_date('01/02/2024', 'dd/mm/yyyy') and  TO_date('02/03/2024', 'dd/mm/yyyy')

UNION ALL
SELECT distinct HOU.ORGANIZATION_CODE EMPRESA,
                HL.LOCATION_CODE LOCAL_ENTREGA,
                reo.status,
                REO.OPERATION_ID RECEBIMENTO,
                CFIT.INVOICE_TYPE_CODE TIPO_NF,
                CFIT.DESCRIPTION DESCRICAO_TIPO_NF,
                CFFE.DOCUMENT_NUMBER CNPJ_GE,
                RV.VENDOR_NAME FORNECEDOR_CLIENTE,
                RV.DOCUMENT_NUMBER CNPJ_CPF,
                RV.VENDOR_SITE_CODE VENDOR_SITE_CODE,
                RV.CITY_CODE CIDADE,
                RV.STATE_CODE ESTADO,
                RI.INVOICE_NUM NOTA_FISCAL,
                RI.INVOICE_DATE DATA_EMISSAO,
                REO.RECEIVE_DATE DATA_RECEBIMENTO,
                RI.FIRST_PAYMENT_DATE VENCTO,
                RI.DESCRIPTION DESCRICAO,
                CFS.STATE_CODE ESTADO_ORIGEM,
                CFC1.CITY_CODE CIDADE_ORIGEM,
                CFS1.STATE_CODE ESTADO_DESTINO,                
                CFC2.CITY_CODE CIDADE_DESTINO,
                dbms_lob.substr(RI.COMMENTS, 5000, 1) INFORMAÃ‡OES_ADICIONAIS,
                dbms_lob.substr(RI.FISCO_ADDITIONAL_INFORMATION, 5000, 1),
                dbms_lob.substr(RI.REFERENCE, 5000, 1),
                RI.ELETRONIC_INVOICE_KEY CHAVE_ELETRONICA,
                (1/ri.PO_CONVERSION_RATE) TAXA_CAMBIO,
                RI.TOTAL_FOB_AMOUNT,
                RI.IMPORTATION_NUMBER NUMERO_DI,
                RI.DI_DATE DATA_DI,
                RI.FREIGHT_INTERNATIONAL FRETE_INTERN_TOTAL,
                RI.IMPORTATION_INSURANCE_AMOUNT SEGURO_INTERN_TOTAL,
                RI.IMPORT_OTHER_VAL_NOT_ICMS OUTRAS_DESP_SEM_ICMS_TOTAL,
                RI.IMPORT_OTHER_VAL_INCLUDED_ICMS OUTRAS_DESP_COM_ICMS_TOTAL,
                RI.IMPORTATION_TAX_AMOUNT II_TOTAL,
                RI.DOLLAR_CUSTOMS_EXPENSE,
                RI.DOLLAR_FREIGHT_INTERNATIONAL,
                RI.DOLLAR_IMPORTATION_PIS_AMOUNT,
                RI.DOLLAR_IMPORTATION_TAX_AMOUNT,
                RI.DOLLAR_IMPORT_CIDE_AMOUNT,
                RI.DOLLAR_IMPORT_COFINS_AMOUNT,
                RI.DOLLAR_INSURANCE_AMOUNT,
                RI.DOLLAR_INVOICE_AMOUNT,
                RI.DOLLAR_OTHER_VAL_INCLUDED_ICMS,
                RI.DOLLAR_OTHER_VAL_NOT_ICMS,
                RI.DOLLAR_SISCOMEX_AMOUNT,
                RI.DOLLAR_TOTAL_CIF_AMOUNT,
                RI.DOLLAR_TOTAL_FOB_AMOUNT,
                RI.ATTRIBUTE1 WF,
                RI.ATTRIBUTE2 EMBARQUE,
                RI.ATTRIBUTE3 DI,
                CFO.CFO_CODE CFOP,
                RI.FREIGHT_AMOUNT,
                RI.OTHER_EXPENSES,
                RI.GROSS_TOTAL_AMOUNT TOTAL_NOTA,
                RI.RETURN_INVOICE_NUM,
                RI.RETURN_SERIES,
                RI.RETURN_AMOUNT,
                RIL.INVOICE_LINE_ID,
                PrHA.SEGMENT1 PO_RMA,
                MSI.SEGMENT1 ITEM,
                RIL.DESCRIPTION DESCRICAO_ITEM,
                RIL.ITEM_NUMBER SEQ_ITEM,
                CFFC.CLASSIFICATION_CODE NCM,
               CFIU.UTILIZATION_CODE UTILIZACAO_FISCAL,
                CFIU.DESCRIPTION DESCRICAO_UTILIZACAO_FISCAL,
                RIL.QUANTITY QUANTIDADE,
                RIL.UNIT_PRICE PRECO_UNIT,
                RIL.NET_AMOUNT PRECO_TOTAL_ITEM,
                RIL.TOTAL_AMOUNT ITEM_TOTAL_AMOUNT,
                RIL.ICMS_BASE BASE_ICMS,
                RIL.ICMS_TAX ALIQUOTA_ICMS,
                RIL.ICMS_AMOUNT VALOR_ICMS,
                RIL.DEFERRED_ICMS_AMOUNT                 ICMS_DIFERIDO_AMNT,
                RIL.ICMS_AMOUNT_RECOVER CREDITO_ICMS,
                RIL.TRIBUTARY_STATUS_CODE CST_ICMS,
                RIL.ICMS_TAX_CODE INDICADOR_ICMS,
                RIL.DIFF_ICMS_TAX DIFAL_ALIQUOTA,
                RIL.DIFF_ICMS_AMOUNT DIFAL_VALOR,
                RIL.DIFF_ICMS_AMOUNT_RECOVER,
                RIL.ICMS_ST_BASE BASE_ICMS_ST,
                RIL.ICMS_ST_AMOUNT ICMS_ST_AMOUNT,
                RIL.ICMS_DEST_BASE_AMOUNT BASE_ICMS_DEST,
                RIL.ICMS_FCP_DEST_PERC FCP_RATE,
                RIL.ICMS_DEST_TAX ICMS_RATE_DEST,
                RIL.ICMS_SHARING_INTER_PERC,
                RIL.ICMS_FCP_AMOUNT,
                RIL.ICMS_SHARING_SOURCE_AMOUNT,
                RIL.ICMS_SHARING_DEST_AMOUNT,
                RIL.CEST_CODE,
                RIL.IPI_BASE_AMOUNT BASE_IPI,
                RIL.IPI_TAX ALIQUOTA_IPI,
                RIL.IPI_AMOUNT VALOR_IPI,
                RIL.IPI_AMOUNT_RECOVER CREDITO_IPI,
                RIL.IPI_TRIBUTARY_CODE CST_IPI,
                RIL.IPI_TAX_CODE INDICADOR_IPI,
                RIL.PIS_BASE_AMOUNT BASE_PIS,
                RIL.PIS_TAX_RATE ALIQ_PIS,
                RIL.PIS_AMOUNT,
                RIL.PIS_AMOUNT_RECOVER CREDITO_PIS,
                RIL.PIS_TRIBUTARY_CODE CST_PIS,
                RIL.COFINS_BASE_AMOUNT BASE_COFINS,
                RIL.COFINS_TAX_RATE ALIQ_COFINS,
                RIL.COFINS_AMOUNT,
                RIL.COFINS_AMOUNT_RECOVER CREDITO_COFINS,
                RIL.COFINS_TRIBUTARY_CODE CST_COFINS,
                RIL.IMPORTATION_PIS_COFINS_BASE BASE_PIS_COFINS_IMPORTACAO,
                RIL.IMPORTATION_PIS_AMOUNT VALOR_PIS_IMPORTACAO,
                RIL.IMPORTATION_COFINS_AMOUNT VALOR_COFINS_IMPORTACAO,
                RIL.IMPORT_OTHER_VAL_NOT_ICMS OUTRS_DESP_SEM_BASE_ICMS_LINHA,
                RIL.IMPORT_OTHER_VAL_INCLUDED_ICMS OUTRS_DESP_COM_BASE_ICMS_LINHA,
                RIL.FOB_AMOUNT,
                RIL.FREIGHT_INTERNACIONAL,
                RIL.IMPORTATION_TAX_AMOUNT,
                RIL.IMPORTATION_INSURANCE_AMOUNT,
                RIL.FCP_BASE_AMOUNT,
                RIL.FCP_RATE,
                RIL.FCP_AMOUNT,
                RIL.FCP_ST_BASE_AMOUNT,
                RIL.FCP_ST_RATE,
                RIL.FCP_ST_AMOUNT,
                RIL.OPERATION_FISCAL_TYPE,
                RI.IR_CATEG CATEGORIA_IRPJ,
                RI.IR_BASE BASE_IRPJ,
                RI.IR_TAX ALIQUOTA_IRPJ,
                RI.IR_AMOUNT IR_RETIDO_PJ,
                CFC.CITY_CODE LOCAL_PRESTACAO_SERVICO,
                RIL.ISS_BASE_AMOUNT BASE_ISS_RETIDO,
                RIL.ISS_TAX_RATE ALIQUOTA_ISS_RETIDO,
                RIL.ISS_TAX_AMOUNT VALOR_ISS_RETIDO,
                RIL.ISS_FO_BASE_AMOUNT BASE_ISS_INFORMATIVO,
                RIL.ISS_FO_TAX_RATE ALIQUOTA_ISS_INFORMATIVO,
                RIL.ISS_FO_AMOUNT VALOR_ISS_INFORMATIVO,
                CFST.SERVICE_TYPE_CODE CODIGO_SERVICO,
                RI.CNO_NUMBER,
                RI.INSS_BASE BASE_INSS,
                RI.INSS_TAX ALIQUOTA_INSS,
                RI.INSS_AMOUNT VALOR_INSS,
                RI.INSS_AUTONOMOUS_INVOICED_TOTAL INSS_AUTONOMO,
                RI.INSS_AUTONOMOUS_TAX ALIQUOTA_INSS_AUTONOMO,
                RI.INSS_AUTONOMOUS_AMOUNT VALOR_INSS_AUTONOMO,
                RI.INSS_ADDITIONAL_BASE_1 BASE_INSS_ADICIONAL_1,
                RI.INSS_ADDITIONAL_TAX_1 ALIQUOTA_INSS_ADICIONAL_1,
                RI.INSS_ADDITIONAL_AMOUNT_1 VALOR_INSS_ADICIONAL_1,
                RI.INSS_ADDITIONAL_BASE_2 BASE_INSS_ADICIONAL_2,
                RI.INSS_ADDITIONAL_TAX_2 ALIQUOTA_INSS_ADICIONAL_2,
                RI.INSS_ADDITIONAL_AMOUNT_2 VALOR_INSS_ADICIONAL_2,
                RI.INSS_ADDITIONAL_BASE_3 BASE_INSS_ADICIONAL_3,
                RI.INSS_ADDITIONAL_TAX_3 ALIQUOTA_INSS_ADICIONAL_3,
                RI.INSS_ADDITIONAL_AMOUNT_3 VALOR_INSS_ADICIONAL_3,
                RI.INCOME_CODE CODIGO_PGTO,
                AW.NAME GRUPO_RETENCAO,
                AW.DESCRIPTION DESCRICAO_GRUPO_RETENCAO,
                RIL.ATTRIBUTE_CATEGORY,
                RIL.ATTRIBUTE1 NF_REMESSA,
                RIL.ATTRIBUTE2 SERIE_REMESSA,
                RIL.ATTRIBUTE3 LOTE,
                NVL(RIL.ATTRIBUTE3,RIL.ATTRIBUTE14) LOTE_INT_REQ,
                RIL.ATTRIBUTE4 QTDE_LOTE,
                RIL.MED_MAXIMUM_PRICE_CONSUMER,
                RIL.ANVISA_PRODUCT_CODE,
                RIL.ANVISA_EXEMPTION_REAZON,
                FD.USER_NAME SSO,
                FD.DESCRIPTION NOME,
                FD.EMAIL_ADDRESS,
                GCC.SEGMENT8 PLINE

  FROM APPS.CLL_F189_VENDORS_V           RV,
       APPS.CLL_F189_ENTRY_OPERATIONS    REO,
       APPS.CLL_F189_INVOICES            RI,
       APPS.CLL_F189_INVOICE_LINES       RIL,
       APPS.MTL_PARAMETERS               HOU,
       APPS.CLL_F189_FISCAL_OPERATIONS   CFO,
       APPS.MTL_SYSTEM_ITEMS             MSI,
       APPS.CLL_F189_INVOICE_TYPES       CFIT,
       APPS.AP_AWT_GROUPS                AW,
       APPS.CLL_F189_CITIES              CFC,
       APPS.CLL_F189_CITY_SRV_TYPE_RELS  CFCST,
       APPS.CLL_F189_SERVICE_TYPES       CFST,
       APPS.CLL_F189_ITEM_UTILIZATIONS   CFIU,
       APPS.CLL_F189_FISCAL_CLASS        CFFC,
       APPS.HR_LOCATIONS_ALL             HL,
       APPS.FND_USER                     FD,
       APPS.CLL_F189_FISCAL_ENTITIES_ALL CFFE,
        APPS.PO_REQUISITION_LINES_ALL prla,
        APPS.PO_REQUISITION_HEADERS_ALL prha,
       --APPS.PO_LINE_LOCATIONS_ALL        PLLA,
       --APPS.PO_HEADERS_ALL               PHA,
       APPS.GL_CODE_COMBINATIONS_KFV     GCC,
        APPS.CLL_F189_STATES              CFS,
       APPS.CLL_F189_STATES              CFS1,
       APPS.CLL_F189_CITIES              CFC1,
       APPS.CLL_F189_CITIES              CFC2

WHERE 1 = 1
   AND RI.INVOICE_ID = RIL.INVOICE_ID
   AND RI.ENTITY_ID = RV.ENTITY_ID
   AND REO.OPERATION_ID = RI.OPERATION_ID
   AND REO.ORGANIZATION_ID = RI.ORGANIZATION_ID
   and reo.status = 'COMPLETE'
   AND HOU.ORGANIZATION_ID = RI.ORGANIZATION_ID
   AND RIL.CFO_ID = CFO.CFO_ID
   AND MSI.INVENTORY_ITEM_ID(+) = RIL.ITEM_ID
   AND MSI.ORGANIZATION_ID = RIL.ORGANIZATION_ID
   AND MSI.COST_OF_SALES_ACCOUNT = GCC.CODE_COMBINATION_ID
   AND CFIT.INVOICE_TYPE_ID = RI.INVOICE_TYPE_ID
   AND RIL.AWT_GROUP_ID = AW.GROUP_ID(+)
   AND RI.ISS_CITY_ID = CFC.CITY_ID(+)
   AND RI.DFLT_CITY_SERVICE_TYPE_REL_ID = CFCST.CITY_SERVICE_TYPE_REL_ID(+)
   AND CFCST.MUNICIPAL_SERVICE_TYPE_ID = CFST.SERVICE_TYPE_ID(+)
   AND CFIU.UTILIZATION_ID = RIL.UTILIZATION_ID
   AND CFFC.CLASSIFICATION_ID = RIL.CLASSIFICATION_ID
   AND HL.LOCATION_ID = REO.LOCATION_ID
   AND REO.LAST_UPDATED_BY = FD.USER_ID
   AND CFFE.LOCATION_ID = HL.LOCATION_ID
   --AND RIL.LINE_LOCATION_ID = PLLA.LINE_LOCATION_ID(+)
   --AND PHA.PO_HEADER_ID(+) = PLLA.PO_HEADER_ID
   AND ril.requisition_line_id = prla.requisition_line_id(+)
   AND prha.requisition_header_id(+) = prla.requisition_header_id
   AND RI.SOURCE_STATE_ID = CFS.STATE_ID (+)
   AND RI.DESTINATION_STATE_ID = CFS1.STATE_ID (+)
   AND RI.SOURCE_CITY_ID = CFC1.CITY_ID (+)
   AND RI.DESTINATION_CITY_ID = CFC2.CITY_ID (+)
   and  ril.requisition_line_id  is not null
   --AND HOU.ORGANIZATION_CODE in ('CSC','CTC','MRC','SGC')
   --AND CFO.CFO_CODE in ('3101')  
   --AND RI.OPERATION_ID = 10115 -- (141774,141775,141766) --> RI NUMBER
   --AND RV.DOCUMENT_TYPE = 'CPF'
   AND trunc(REO.RECEIVE_DATE) between  TO_date('01/02/2024', 'dd/mm/yyyy') and  TO_date('02/03/2024', 'dd/mm/yyyy')


ORDER BY 1,5