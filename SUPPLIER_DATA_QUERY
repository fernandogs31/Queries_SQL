SELECT hro.organization_id AS ORG_ID,
       hro.NAME AS OPERATING_UNIT,
       APS.segment1 AS GSL6,
       APSA.ATTRIBUTE14 GSL_SITE_NUMBER,
       COALESCE(APS.segment1, '') || COALESCE(apsa.attribute14, '') AS GSL9,
       APS.END_DATE_ACTIVE SUPP_END_DATE,
       APSA.INACTIVE_DATE SITE_END_DATE,
       aps.VENDOR_NAME,
       aps.vendor_id,
       aps.vendor_name_alt,
       aps.creation_date SUPP_creation_date,
       aps.LAST_UPDATE_date SUPP_UPDATE_date,
       FND1.user_name supp_updated_by,
       aps.VENDOR_TYPE_LOOKUP_CODE,
       aps.ORGANIZATION_TYPE_LOOKUP_CODE,
       apsa.vendor_site_code,
       apsa.vendor_site_id,
       apsa.creation_date Site_creation_date,
       apsa.LAST_UPDATE_date Site_UPDATE_date,
       FND2.user_name site_updated_by,
       apsa.vat_registration_num TAX_REGISTRATION_NUM,
       apsa.AUTO_TAX_CALC_FLAG CALCULATE_TAX,
       apsa.country,
       apsa.city,
       apsa.county,
       apsa.STATE,
       apsa.zip AS postalcode,
       apsa.province,
       apsa.address_line1,
       apsa.address_line2,
       apsa.address_line3,
       apsa.address_line4,
       apsa.AREA_CODE,
       apsa.PHONE,
       apsa.FAX,
       apsa.FAX_AREA_CODE,
       APSA.LANGUAGE,
       apsa.DUNS_NUMBER,
       apsa.purchasing_site_flag,
       apsa.pay_site_flag,
       apsa.RFQ_ONLY_SITE_FLAG,
       aps.ALLOW_AWT_FLAG SUPPLIER_ALLOW_WITHHOLDING_TAX,
       apsa.ALLOW_AWT_FLAG SITE_ALLOW_WITHHOLDING_TAX,
       aps.payment_method_lookup_code PAYMENT_METHOD_CODE_SUPP,
       (SELECT IEPPM.PAYMENT_METHOD_CODE
        FROM   APPS.IBY_EXT_PARTY_PMT_MTHDS IEPPM,
               APPS.IBY_EXTERNAL_PAYEES_ALL IEPA
        WHERE  IEPA.EXT_PAYEE_ID = IEPPM.EXT_PMT_PARTY_ID
           AND IEPA.SUPPLIER_SITE_ID = APSA.VENDOR_SITE_ID
           AND IEPPM.PRIMARY_FLAG = 'Y'
           and NVL(IEPPM.INACTIVE_DATE, SYSDATE + 1) > SYSDATE
           and NVL(IEPA.INACTIVE_DATE, SYSDATE + 1) > SYSDATE
          AND IEPA.ORG_ID = APSA.ORG_ID) PAYMENT_METHOD_CODE_SITE,
       (SELECT IEPA.EXCLUSIVE_PAYMENT_FLAG
          FROM APPS.IBY_EXTERNAL_PAYEES_ALL IEPA
         WHERE IEPA.SUPPLIER_SITE_ID = APSA.VENDOR_SITE_ID
           and NVL(IEPA.INACTIVE_DATE, SYSDATE + 1) > SYSDATE
           AND IEPA.ORG_ID = APSA.ORG_ID) SITE_EXCLUSIVE_PAYMENT_FLAG,
       (select name
          from apps.ap_terms_tl APT
         where APT.term_id = apsa.terms_id
           and language = USERENV('LANG')) AS Payment_Term_Name,
       apsa.SUPPLIER_NOTIF_METHOD supplier_notif_method,
       apsa.email_address,
       apsa.remittance_email,
       APSA.ATTRIBUTE11 TRANSMIT_EMAIL_ADDRESS,
       APSA.ATTRIBUTE12 TRANSMIT_CODE,
       apsa.GLOBAL_ATTRIBUTE_CATEGORY SITE_GLOBAL_ATTR_CONTEXT_VALUE,
       apsa.GLOBAL_ATTRIBUTE1 COLLECTION_DOC_ASSOCIATION,
       apsa.GLOBAL_ATTRIBUTE2 INTEREST_TYPE,
       apsa.GLOBAL_ATTRIBUTE3 INTEREST_RATE,
       apsa.GLOBAL_ATTRIBUTE4 INTEREST_PERIOD,
       apsa.GLOBAL_ATTRIBUTE5 INTEREST_FARMULA,
       apsa.GLOBAL_ATTRIBUTE6 INTEREST_GRACE_DAYS,
       apsa.GLOBAL_ATTRIBUTE7 PENALTY_TYPE,
       apsa.GLOBAL_ATTRIBUTE8 PENALTY_RATE,
       apsa.GLOBAL_ATTRIBUTE9 SITE_GLOBAL_ATTRIBUTE9,
       (SELECT meaning
          FROM APPS.FND_LOOKUPS FL
         WHERE FL.LOOKUP_TYPE like 'JLBR_INSCRIPTION_TYPE'
           and fl.lookup_code = APSA.global_attribute9) INSCRIPTION_TYPE,
       apsa.GLOBAL_ATTRIBUTE10 INSCRIPTION_NUMBER,
       apsa.GLOBAL_ATTRIBUTE11 INSCRIPTION_BRANCH,
       apsa.GLOBAL_ATTRIBUTE12 INSCRIPTION_DIGIT,
       apsa.GLOBAL_ATTRIBUTE13 STATE_INSCRIPTION,
       apsa.GLOBAL_ATTRIBUTE14 CITY_INSCRIPTION,
       apsa.GLOBAL_ATTRIBUTE15 CONTRIBUTOR_TYPE,
       apsa.GLOBAL_ATTRIBUTE16 TAX_CALENDAR,
       apsa.GLOBAL_ATTRIBUTE17 SUFRAMA_INSCRIPTION_NUMBER,
       DECODE(apsa.Country, 'CORPORATION', 'NON-US CORPORATION') Tax_Classification,
       aps.NUM_1099 tax_number_1,
       aps.INDIVIDUAL_1099 tax_number_2,
       APS.MATCH_OPTION MATCH_OPTION_SUPP,
       APSA.MATCH_OPTION MATCH_OPTION_SITE,
       aps.HOLD_ALL_PAYMENTS_FLAG hold_all_payments_flag_sup,
       aps.HOLD_FUTURE_PAYMENTS_FLAG hold_future_payments_flag_sup,
       aps.HOLD_UNMATCHED_INVOICES_FLAG hold_unmatched_invcs_flag_sup,
       apsa.HOLD_ALL_PAYMENTS_FLAG hold_all_payments_flag_site,
       apsa.HOLD_FUTURE_PAYMENTS_FLAG hold_future_payments_flag_site,
       apsa.HOLD_UNMATCHED_INVOICES_FLAG hold_unmatched_invcs_flag_site,
       apsa.pay_on_code,
       apsa.FOB_Lookup_code,
       aps.TERMS_DATE_BASIS SUPPLIER_TERMS_DATE_BASIS,
       apsa.TERMS_DATE_BASIS SITE_TERMS_DATE_BASIS,
       aps.PAY_GROUP_LOOKUP_CODE SUPPLIER_PAY_GROUP_LOOKUP_CODE,
       apsa.PAY_GROUP_LOOKUP_CODE SITE_PAY_GROUP_LOOKUP_CODE,
       APS.TAX_REPORTING_NAME,
       apsa.TAX_REPORTING_SITE_FLAG,
       aps.INVOICE_CURRENCY_CODE SUPP_INVOICE_CURRENCY_CODE,
       apsa.INVOICE_CURRENCY_CODE site_INVOICE_CURRENCY_CODE,
       aps.PAYMENT_CURRENCY_CODE SUPP_PAYMENT_CURRENCY_CODE,
       apsa.PAYMENT_CURRENCY_CODE site_PAYMENT_CURRENCY_CODE,
       aps.payment_priority SUPP_payment_priority,
       apsa.payment_priority site_payment_priority,
       aps.attribute_category supp_attribute_category,
       aps.ATTRIBUTE1 SUPP_ATTRIBUTE1,
       aps.ATTRIBUTE2 SUPP_ATTRIBUTE2,
       aps.ATTRIBUTE3 SUPP_ATTRIBUTE3,
       aps.ATTRIBUTE4 SUPP_ATTRIBUTE4,
       aps.ATTRIBUTE5 SUPP_ATTRIBUTE5,
       aps.ATTRIBUTE6 SUPP_ATTRIBUTE6,
       aps.ATTRIBUTE7 SUPP_ATTRIBUTE7,
       aps.ATTRIBUTE8 SUPP_ATTRIBUTE8,
       aps.ATTRIBUTE9 SUPP_ATTRIBUTE9,
       aps.ATTRIBUTE10 SUPP_ATTRIBUTE10,
       aps.ATTRIBUTE11 SUPP_ATTRIBUTE11,
       aps.ATTRIBUTE12 SUPP_ATTRIBUTE12,
       aps.ATTRIBUTE13 SUPP_ATTRIBUTE13,
       aps.ATTRIBUTE14 SUPP_ATTRIBUTE14,
       aps.ATTRIBUTE15 SUPP_ATTRIBUTE15,
       aps.GLOBAL_ATTRIBUTE_CATEGORY SUPP_GLOBAL_ATTR_CONTEXT_VALUE,
       aps.GLOBAL_ATTRIBUTE1 SUPP_GLOBAL_ATTRIBUTE1,
       aps.GLOBAL_ATTRIBUTE2 SUPP_GLOBAL_ATTRIBUTE2,
       aps.GLOBAL_ATTRIBUTE3 SUPP_GLOBAL_ATTRIBUTE3,
       aps.GLOBAL_ATTRIBUTE4 SUPP_GLOBAL_ATTRIBUTE4,
       aps.GLOBAL_ATTRIBUTE5 SUPP_GLOBAL_ATTRIBUTE5,
       aps.GLOBAL_ATTRIBUTE6 SUPP_GLOBAL_ATTRIBUTE6,
       aps.GLOBAL_ATTRIBUTE7 SUPP_GLOBAL_ATTRIBUTE7,
       aps.GLOBAL_ATTRIBUTE8 SUPP_GLOBAL_ATTRIBUTE8,
       aps.GLOBAL_ATTRIBUTE9 SUPP_GLOBAL_ATTRIBUTE9,
       aps.GLOBAL_ATTRIBUTE10 SUPP_GLOBAL_ATTRIBUTE10,
       aps.GLOBAL_ATTRIBUTE11 SUPP_GLOBAL_ATTRIBUTE11,
       aps.GLOBAL_ATTRIBUTE12 SUPP_GLOBAL_ATTRIBUTE12,
       aps.GLOBAL_ATTRIBUTE13 SUPP_GLOBAL_ATTRIBUTE13,
       aps.GLOBAL_ATTRIBUTE14 SUPP_GLOBAL_ATTRIBUTE14,
       aps.GLOBAL_ATTRIBUTE15 SUPP_GLOBAL_ATTRIBUTE15,
       aps.GLOBAL_ATTRIBUTE16 SUPP_GLOBAL_ATTRIBUTE16,
       aps.GLOBAL_ATTRIBUTE17 SUPP_GLOBAL_ATTRIBUTE17,
       aps.GLOBAL_ATTRIBUTE18 SUPP_GLOBAL_ATTRIBUTE18,
       aps.GLOBAL_ATTRIBUTE19 SUPP_GLOBAL_ATTRIBUTE19,
       aps.GLOBAL_ATTRIBUTE20 SUPP_GLOBAL_ATTRIBUTE10,
       apsa.attribute_category site_attribute_category,
       apsa.ATTRIBUTE1 SITE_ATTRIBUTE1,
       apsa.ATTRIBUTE2 SITE_ATTRIBUTE2,
       apsa.ATTRIBUTE3 SITE_ATTRIBUTE3,
       apsa.ATTRIBUTE4 SITE_ATTRIBUTE4,
       apsa.ATTRIBUTE5 SITE_ATTRIBUTE5,
       apsa.ATTRIBUTE6 SITE_ATTRIBUTE6,
       apsa.ATTRIBUTE7 SITE_ATTRIBUTE7,
       apsa.ATTRIBUTE8 SITE_ATTRIBUTE8,
       apsa.ATTRIBUTE9 SITE_ATTRIBUTE9,
       apsa.ATTRIBUTE10 SITE_ATTRIBUTE10,
       apsa.ATTRIBUTE13 SITE_ATTRIBUTE13,
       apsa.ATTRIBUTE15 SITE_ATTRIBUTE15,
       apsa.GLOBAL_ATTRIBUTE18 SITE_GLOBAL_ATTRIBUTE18,
       apsa.GLOBAL_ATTRIBUTE19 SITE_GLOBAL_ATTRIBUTE19,
       apsa.GLOBAL_ATTRIBUTE20 SITE_GLOBAL_ATTRIBUTE20,
       f.concatenated_segments AP_LIABILITY_ACCOUNT,
       G.concatenated_segments PREPAYMENT_ACCOUNT,
       H.concatenated_segments FUTURE_PAYMENT_ACCOUNT
   
 FROM  apps.AP_SUPPLIERS              aps,
       apps.AP_SUPPLIER_SITES_ALL     apsa,
       apps.HR_ALL_ORGANIZATION_UNITS HRO,
       apps.FND_USER                  FND1,
       apps.FND_USER                  FND2,
       apps.GL_CODE_COMBINATIONS_KFV  F,
       apps.GL_CODE_COMBINATIONS_KFV  G,
       apps.GL_CODE_COMBINATIONS_KFV  H
       
WHERE aps.VENDOR_ID = apsa.VENDOR_ID
   AND apsa.ORG_ID = hro.ORGANIZATION_ID
   and hro.name = 'GEMSAM_OU_BRL_GEMS_BRA'
   and aps.LAST_UPDATED_BY = FND1.USER_ID
   and apsa.last_updated_by = fnd2.user_id
   AND F.CODE_COMBINATION_ID(+) = apsa.ACCTS_PAY_CODE_COMBINATION_ID
   AND G.CODE_COMBINATION_ID(+) = apsa.PREPAY_CODE_COMBINATION_ID
   AND H.CODE_COMBINATION_ID(+) = apsa.FUTURE_DATED_PAYMENT_CCID
